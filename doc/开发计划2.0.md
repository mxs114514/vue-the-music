# Vue + Express 全栈音乐播放器：10 天垂直切片开发计划

**目标**：在 10 天内完成一个包含前后端交互、管理后台、数据可视化的全栈音乐项目。
**核心策略**：采用“垂直切片”模式，按功能模块打通前后端，确保每天都有可运行的产出。

> **技术栈**：Vue 3 + TypeScript + Pinia + Vite + Element Plus + Express + SQLite + Prisma + Web Audio API + Canvas + PWA

## 📅 总体节奏

- **Day 1-2**：全栈基建与数据链路打通
- **Day 3-5**：前台核心功能（播放、歌词、可视化）
- **Day 6-7**：后台管理功能（增删改查、上传）
- **Day 8-9**：高级特性与工程化（PWA、测试、主题）
- **Day 10**：文档与交付

---

## 🗓️ 详细每日计划表

### Day 1：全栈基建 (Infrastructure)
**目标**：前后端环境搭建完毕，可以互相通信。

- ✅ **项目结构初始化**：
  - 根目录创建 `server/` (Express + TS)
  - 配置 `vite.config.ts` 的 `server.proxy` 解决跨域
- ✅ **数据库环境**：
  - 初始化 Prisma + SQLite (`npx prisma init`)
  - 编写 `schema.prisma` (定义 `Song` 模型)
- ✅ **后端基础**：
  - 启动 Express 服务器 (端口 3000)
  - 编写测试接口 `GET /api/health`

### Day 2：垂直切片一：数据链路打通 (Data Flow)
**目标**：前端能从数据库获取歌单并渲染。

- ✅ **后端开发**：
  - 实现 `GET /api/songs` (获取所有歌曲)
  - 编写种子脚本 (`prisma/seed.ts`) 注入初始数据
- ✅ **前端对接**：
  - 改造 `stores/player.ts`，添加 `fetchSongList` Action
  - 使用 `fetch` 或 `axios` 调用后端接口
- ✅ **UI 渲染**：
  - 在首页展示歌曲列表 (基础 `v-for`)

### Day 3：垂直切片二：核心播放 (Core Playback)
**目标**：实现 1.0 计划中的基础播放功能，但数据源来自后端。

- ✅ **播放器组件**：
  - 完善 `AudioPlayer.vue`，集成 `<audio>` 标签
  - 实现 播放/暂停/上一曲/下一曲 逻辑
- ✅ **状态管理**：
  - Pinia 管理 `isPlaying`, `currentSong`, `playMode`
  - 集成 `pinia-plugin-persistedstate` 实现持久化
- ✅ **UI 交互**：
  - 底部播放栏布局
  - 播放按钮状态切换 

### Day 4：垂直切片三：交互控制 (Interaction)
**目标**：实现精准控制与播放列表管理。

- ✅ **进度控制**：
  - 使用 `el-slider` 实现进度条
  - 监听 `timeupdate` 事件
  - 实现拖拽跳转 (`currentTime`)
- ✅ **音量控制**：
  - 独立音量滑块
- ✅ **播放列表页**：
  - 创建 `/playlist` 路由
  - 使用 `el-table` 展示完整歌单
  - 实现“点击播放”交互

### Day 5：垂直切片四：视听增强 (Audio/Visual)
**目标**：攻克最难的前端特效（歌词 + 可视化）。

- ✅ **LRC 歌词同步**：
  - 编写 `utils/lyrics.ts` 解析器 (正则提取时间戳)
  - 实现 `Lyrics.vue` 组件，根据 `currentTime` 高亮当前行
  - 实现歌词自动滚动
- ✅ **音频可视化**：
  - 接入 **Web Audio API** (`AudioContext`, `AnalyserNode`)
  - 创建 `Visualizer.vue`
  - 使用 Canvas 绘制动态柱状频谱

### Day 6：垂直切片五：管理后台基础 (Admin Basic)
**目标**：实现课设要求的“管理功能”核心。

- ✅ **后台布局**：
  - 创建 `/admin` 路由与独立布局
  - 侧边栏导航 (歌曲管理、用户管理)
- ✅ **歌曲管理 (CRUD)**：
  - 后端：实现 `DELETE /api/songs/:id` 和 `PUT /api/songs/:id`
  - 前端：`el-table` 增加“编辑”和“删除”按钮
  - 实现删除确认与列表刷新

### Day 7：垂直切片六：高级管理与上传 (Admin Advanced)
**目标**：实现文件上传与数据看板。

- ✅ **文件上传**：
  - 后端：配置 `multer` 中间件，实现 `POST /api/songs`
  - 处理 MP3 文件存储与数据库记录插入
  - 前端：使用 `el-upload` 组件上传歌曲
- ✅ **数据看板**：
  - 简单的统计页 (歌曲总数、存储占用)
  - (可选) 集成 ECharts 展示简单的图表

### Day 8：体验优化 (UX/PWA)
**目标**：提升应用质感，实现 1.0 计划中的 PWA。

- ✅ **主题定制**：
  - 配置 Element Plus 全局主题色
  - 实现 **暗色模式** (Dark Mode) 切换逻辑
- ✅ **PWA 离线应用**：
  - 配置 `vite-plugin-pwa`
  - 生成 `manifest.json` (图标、名称)
  - 测试桌面安装功能

### Day 9：工程化与质量 (Quality)
**目标**：代码重构与测试，满足课设对代码质量的要求。

- ✅ **代码重构**：
  - 抽离 `useAudioPlayer`, `useLyrics` 等 Composables
  - 确保 TypeScript 类型定义完整 (`interface Song`, `interface User`)
- ✅ **单元测试**：
  - 配置 Vitest
  - 编写核心工具函数测试 (如 `parseLrc` 的测试用例)
- ✅ **代码规范**：
  - 运行 ESLint + Prettier 格式化全项目

### Day 10：文档与交付 (Delivery)
**目标**：准备答辩材料。

- ✅ **文档编写**：
  - 完善 `README.md` (项目截图、运行指南、技术栈列表)
- ✅ **演示准备**：
  - 录制操作演示视频 (覆盖前台播放、后台管理、可视化效果)
  - 准备答辩常见问题 (Web Audio 原理、前后端交互流程)
- ✅ **打包部署**：
  - `npm run build`
  - 确保本地生产环境运行正常
